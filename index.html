<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Zodiac Oracle ‚ú®</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Cinzel:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --primary: #8a2be2;
    --secondary: #00d4ff;
    --accent: #ff00ff;
    --success: #00ff88;
    --warning: #ffaa00;
    --danger: #ff5555;
    --dark: #0a0a1a;
    --light: #e6e6ff;
    --card-bg: rgba(20, 20, 40, 0.9);
    --card-border: rgba(100, 100, 255, 0.3);
}

body {
    font-family: 'Space Grotesk', sans-serif;
    background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 100%);
    color: var(--light);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
}

.stars {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #000 url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><circle cx="50" cy="50" r="1" fill="white" opacity="0.5"/></svg>') repeat;
    z-index: -1;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    position: relative;
    z-index: 1;
}

.header {
    text-align: center;
    padding: 30px 20px;
    background: rgba(10, 10, 30, 0.8);
    border-radius: 20px;
    margin-bottom: 30px;
    border: 1px solid var(--card-border);
    backdrop-filter: blur(10px);
}

.logo i {
    font-size: 3rem;
    color: var(--secondary);
    animation: glow 2s infinite alternate;
}

@keyframes glow {
    from { filter: drop-shadow(0 0 5px var(--secondary)); }
    to { filter: drop-shadow(0 0 20px var(--secondary)); }
}

.header h1 {
    font-family: 'Cinzel', serif;
    font-size: 2.5rem;
    background: linear-gradient(45deg, var(--secondary), var(--accent));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin: 15px 0 10px 0;
}

.tagline {
    color: var(--light);
    opacity: 0.8;
    font-size: 1rem;
    margin-bottom: 20px;
}

/* Navigation Buttons */
.nav-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
    gap: 15px;
}

.btn-back {
    padding: 12px 25px;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    background: rgba(138, 43, 226, 0.3);
    color: var(--light);
    display: inline-flex;
    align-items: center;
    gap: 10px;
    border: 2px solid var(--primary);
}

.btn-back:hover {
    background: var(--primary);
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(138, 43, 226, 0.3);
}

/* Step Card */
.step-card {
    background: var(--card-bg);
    border-radius: 20px;
    border: 2px solid var(--card-border);
    backdrop-filter: blur(10px);
    margin-bottom: 20px;
    overflow: hidden;
    transition: all 0.3s;
}

.step-card.active {
    border-color: var(--secondary);
    box-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
}

.step-card.completed {
    border-color: var(--success);
    opacity: 0.7;
}

.step-header {
    padding: 20px 25px;
    background: linear-gradient(90deg, rgba(138, 43, 226, 0.3), rgba(0, 212, 255, 0.3));
    border-bottom: 1px solid var(--card-border);
    display: flex;
    align-items: center;
    gap: 15px;
    cursor: pointer;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    font-weight: bold;
}

.step-card.completed .step-number {
    background: var(--success);
}

.step-card.active .step-number {
    background: var(--secondary);
    animation: glow 2s infinite alternate;
}

.step-title {
    flex: 1;
}

.step-title h3 {
    font-size: 1.3rem;
    margin-bottom: 5px;
}

.step-title p {
    font-size: 0.9rem;
    opacity: 0.7;
}

.check-icon {
    color: var(--success);
    font-size: 1.5rem;
    display: none;
}

.step-card.completed .check-icon {
    display: block;
}

.step-content {
    padding: 25px;
    display: none;
}

.step-card.active .step-content {
    display: block;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.form-group {
    margin-bottom: 25px;
}

.form-group label {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    color: var(--secondary);
    font-weight: 500;
    font-size: 1rem;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid rgba(100, 100, 255, 0.2);
    border-radius: 12px;
    color: var(--light);
    font-size: 1rem;
    font-family: 'Space Grotesk', sans-serif;
    transition: all 0.3s;
}

.form-group textarea {
    min-height: 100px;
    resize: vertical;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--secondary);
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

/* Camera Section */
.camera-section {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 15px;
    padding: 20px;
    text-align: center;
    border: 2px dashed var(--secondary);
}

#video {
    width: 100%;
    max-width: 400px;
    border-radius: 15px;
    margin: 15px 0;
    display: none;
    border: 2px solid var(--secondary);
}

#canvas {
    display: none;
}

.camera-preview {
    width: 100%;
    max-width: 400px;
    border-radius: 15px;
    margin: 15px auto;
    display: none;
    border: 2px solid var(--success);
}

.location-info {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 12px;
    margin-top: 20px;
    border-left: 4px solid var(--warning);
    display: none;
}

.location-info i {
    color: var(--warning);
}

.btn-camera {
    padding: 12px 25px;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    background: var(--secondary);
    color: var(--dark);
    display: inline-flex;
    align-items: center;
    gap: 10px;
    margin: 10px;
}

.btn-camera:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0, 212, 255, 0.3);
}

.btn-retake {
    background: var(--accent);
    color: white;
}

.btn-disable {
    background: var(--danger);
    color: white;
}

/* Spirit Guides */
.spirit-guides {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
}

.guide-option {
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid transparent;
    border-radius: 15px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
}

.guide-option:hover {
    border-color: var(--secondary);
    transform: translateY(-5px);
}

.guide-option.selected {
    border-color: var(--accent);
    background: rgba(255, 0, 255, 0.1);
    box-shadow: 0 0 20px rgba(255, 0, 255, 0.3);
}

.guide-emoji {
    font-size: 3rem;
    display: block;
    margin-bottom: 10px;
}

.guide-name {
    font-weight: 600;
    color: var(--light);
    display: block;
    margin-bottom: 5px;
}

.guide-power {
    font-size: 0.85rem;
    color: var(--secondary);
    opacity: 0.8;
}

.btn-next {
    width: 100%;
    padding: 15px;
    border: none;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    background: linear-gradient(45deg, var(--primary), var(--accent));
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-top: 20px;
}

.btn-next:hover:not(:disabled) {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(138, 43, 226, 0.5);
}

.btn-next:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Loading Overlay */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(10, 10, 26, 0.95);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    display: none;
}

.loading-spinner {
    width: 60px;
    height: 60px;
    border: 4px solid transparent;
    border-top: 4px solid var(--secondary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 20px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.loading-text {
    text-align: center;
    color: var(--secondary);
    font-size: 1.2rem;
}

/* All Details Display */
.all-details-display {
    background: var(--card-bg);
    border-radius: 20px;
    border: 2px solid var(--accent);
    backdrop-filter: blur(10px);
    padding: 30px;
    margin-top: 20px;
    display: none;
    animation: fadeIn 0.5s ease-out;
}

.all-details-display.show {
    display: block;
}

.all-details-display h2 {
    text-align: center;
    color: var(--secondary);
    margin-bottom: 30px;
    font-family: 'Cinzel', serif;
}

.details-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.details-section {
    background: rgba(0, 0, 0, 0.3);
    padding: 20px;
    border-radius: 15px;
    border-left: 4px solid var(--secondary);
}

.details-section h3 {
    color: var(--secondary);
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.detail-item {
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.detail-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
}

.detail-label {
    color: var(--accent);
    font-weight: 600;
    display: block;
    margin-bottom: 5px;
    font-size: 0.9rem;
}

.detail-value {
    color: var(--light);
    font-size: 1rem;
    line-height: 1.5;
}

/* Share Section */
.share-section {
    text-align: center;
    padding: 40px;
    background: var(--card-bg);
    border-radius: 20px;
    border: 2px solid var(--accent);
    margin-top: 20px;
    display: none;
}

.share-section i {
    font-size: 4rem;
    color: var(--accent);
    margin-bottom: 20px;
    animation: float 3s ease-in-out infinite;
}

.share-section h2 {
    color: var(--secondary);
    margin-bottom: 15px;
    font-family: 'Cinzel', serif;
}

.share-options {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin: 25px 0;
    flex-wrap: wrap;
}

.share-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 20px;
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid transparent;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s;
    min-width: 120px;
}

.share-btn:hover {
    transform: translateY(-5px);
    border-color: var(--secondary);
    background: rgba(0, 212, 255, 0.1);
}

.share-btn.whatsapp:hover {
    border-color: #25D366;
    background: rgba(37, 211, 102, 0.1);
}

.share-btn.instagram:hover {
    border-color: #E4405F;
    background: rgba(228, 64, 95, 0.1);
}

.share-btn.facebook:hover {
    border-color: #1877F2;
    background: rgba(24, 119, 242, 0.1);
}

.share-btn.twitter:hover {
    border-color: #1DA1F2;
    background: rgba(29, 161, 242, 0.1);
}

.share-btn i {
    font-size: 2.5rem;
    margin-bottom: 0;
    animation: none;
}

.share-btn.whatsapp i { color: #25D366; }
.share-btn.instagram i { color: #E4405F; }
.share-btn.facebook i { color: #1877F2; }
.share-btn.twitter i { color: #1DA1F2; }
.share-btn.download i { color: var(--success); }

.share-label {
    font-weight: 600;
    color: var(--light);
}

.qr-code {
    margin: 25px auto;
    padding: 20px;
    background: white;
    border-radius: 15px;
    display: inline-block;
}

.qr-code img {
    width: 200px;
    height: 200px;
    border-radius: 10px;
}

.copy-link {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 12px;
    margin: 20px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.copy-link input {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--light);
    font-size: 0.9rem;
    padding: 10px;
}

.copy-link button {
    background: var(--secondary);
    color: var(--dark);
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s;
}

.copy-link button:hover {
    background: var(--primary);
    color: white;
}

.fortune-image {
    max-width: 100%;
    border-radius: 15px;
    margin: 20px 0;
    border: 3px solid var(--secondary);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}

.thank-you-message {
    text-align: center;
    padding: 40px;
    background: var(--card-bg);
    border-radius: 20px;
    border: 2px solid var(--success);
    margin-top: 20px;
    display: none;
}

.thank-you-message i {
    font-size: 4rem;
    color: var(--success);
    margin-bottom: 20px;
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.thank-you-message h2 {
    color: var(--secondary);
    margin-bottom: 15px;
    font-family: 'Cinzel', serif;
}

/* Fortune Display */
.fortune-display {
    background: var(--card-bg);
    border-radius: 20px;
    border: 2px solid var(--success);
    backdrop-filter: blur(10px);
    padding: 30px;
    margin-top: 20px;
    display: none;
    animation: fadeIn 0.5s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}

.fortune-display.show {
    display: block;
}

.zodiac-profile {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 25px;
    border-bottom: 2px solid var(--card-border);
}

.profile-with-photo {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 30px;
    margin-bottom: 20px;
}

.user-photo {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 3px solid var(--secondary);
    object-fit: cover;
    box-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
}

.zodiac-icon-large {
    font-size: 5rem;
    animation: float 3s ease-in-out infinite;
}

.fortune-display h2 {
    font-size: 2rem;
    background: linear-gradient(45deg, var(--secondary), var(--accent));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 10px;
}

.fortune-display .subtitle {
    color: var(--light);
    opacity: 0.8;
    margin-bottom: 15px;
}

.spirit-display {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    padding: 15px;
    background: rgba(255, 0, 255, 0.1);
    border-radius: 15px;
    margin-bottom: 25px;
}

.spirit-emoji-large {
    font-size: 3rem;
}

.fortune-section {
    background: rgba(0, 0, 0, 0.3);
    padding: 20px;
    border-radius: 15px;
    border-left: 4px solid var(--secondary);
    margin-bottom: 20px;
}

.fortune-section h4 {
    color: var(--secondary);
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.fortune-text {
    line-height: 1.8;
    color: var(--light);
    opacity: 0.9;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-top: 25px;
}

.stat-box {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 12px;
    text-align: center;
    border: 1px solid var(--card-border);
}

.stat-label {
    color: var(--secondary);
    font-size: 0.9rem;
    margin-bottom: 8px;
    display: block;
}

.stat-value {
    color: var(--light);
    font-size: 1.3rem;
    font-weight: bold;
}

@media (max-width: 768px) {
    .spirit-guides {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .profile-with-photo {
        flex-direction: column;
    }
    
    .share-options {
        gap: 10px;
    }
    
    .share-btn {
        min-width: 100px;
        padding: 15px;
    }
    
    .qr-code img {
        width: 150px;
        height: 150px;
    }
    
    .details-grid {
        grid-template-columns: 1fr;
    }
    
    .nav-buttons {
        flex-direction: column;
    }
}
    </style>
</head>
<body>
    <div class="stars"></div>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">
            <p>Saving your cosmic data...</p>
            <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 10px;">Connecting to the stars ‚ú®</p>
        </div>
    </div>
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-crystal-ball"></i>
            </div>
            <h1>Cosmic Zodiac Oracle</h1>
            <p class="tagline">Discover Your Celestial Destiny ‚ú®</p>
        </header>

        <!-- All previous step cards remain the same... -->

        <!-- Step 1: Personal Info -->
        <div class="step-card active" id="step1">
            <div class="step-header" onclick="toggleStep(1)">
                <div class="step-number">1</div>
                <div class="step-title">
                    <h3>Personal Information</h3>
                    <p>Tell us about yourself</p>
                </div>
                <i class="fas fa-check-circle check-icon"></i>
            </div>
            <div class="step-content">
                <div class="form-group">
                    <label><i class="fas fa-user"></i> Your Name *</label>
                    <input type="text" id="name" placeholder="Enter your full name" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-calendar"></i> Birth Date *</label>
                        <input type="date" id="birthDate" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-venus-mars"></i> Gender *</label>
                        <select id="gender" required>
                            <option value="">Select gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                            <option value="Prefer not to say">Prefer not to say</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Email Address *</label>
                    <input type="email" id="email" placeholder="Enter your email" required>
                </div>
                <button class="btn-next" onclick="nextStep(1)">
                    <span>Next Step</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Step 2: Photo & Location -->
        <div class="step-card" id="step2">
            <div class="step-header" onclick="toggleStep(2)">
                <div class="step-number">2</div>
                <div class="step-title">
                    <h3>Capture Your Cosmic Energy</h3>
                    <p>Take a photo for personalized reading</p>
                </div>
                <i class="fas fa-check-circle check-icon"></i>
            </div>
            <div class="step-content">
                <div class="camera-section">
                    <label><i class="fas fa-camera"></i> Take Your Photo</label>
                    <p style="opacity: 0.8; margin: 10px 0;">Your photo will be matched with your zodiac spirit animal</p>
                    <video id="video" autoplay></video>
                    <canvas id="canvas"></canvas>
                    <img id="photoPreview" class="camera-preview">
                    <div>
                        <button class="btn-camera" id="startCamera">
                            <i class="fas fa-camera"></i>
                            <span>Start Camera</span>
                        </button>
                        <button class="btn-camera" id="captureBtn" style="display: none;">
                            <i class="fas fa-camera-retro"></i>
                            <span>Capture Photo</span>
                        </button>
                        <button class="btn-camera btn-retake" id="retakeBtn" style="display: none;">
                            <i class="fas fa-redo"></i>
                            <span>Retake</span>
                        </button>
                        <button class="btn-camera btn-disable" id="disableCamera" style="display: none;">
                            <i class="fas fa-video-slash"></i>
                            <span>Disable Camera</span>
                        </button>
                    </div>
                </div>
                <div class="location-info" id="locationInfo">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Location captured: </span>
                    <span id="locationText">Fetching location...</span>
                </div>
                <button class="btn-next" id="photoNextBtn" onclick="nextStep(2)" disabled>
                    <span>Next Step</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Step 3: Zodiac Sign -->
        <div class="step-card" id="step3">
            <div class="step-header" onclick="toggleStep(3)">
                <div class="step-number">3</div>
                <div class="step-title">
                    <h3>Zodiac Sign & Personality</h3>
                    <p>Select your sun sign and share more</p>
                </div>
                <i class="fas fa-check-circle check-icon"></i>
            </div>
            <div class="step-content">
                <div class="form-group">
                    <label><i class="fas fa-sun"></i> Your Zodiac Sign *</label>
                    <select id="zodiacSign" required>
                        <option value="">Select your zodiac sign</option>
                        <option value="Aries">‚ôà Aries (Mar 21 - Apr 19)</option>
                        <option value="Taurus">‚ôâ Taurus (Apr 20 - May 20)</option>
                        <option value="Gemini">‚ôä Gemini (May 21 - Jun 20)</option>
                        <option value="Cancer">‚ôã Cancer (Jun 21 - Jul 22)</option>
                        <option value="Leo">‚ôå Leo (Jul 23 - Aug 22)</option>
                        <option value="Virgo">‚ôç Virgo (Aug 23 - Sep 22)</option>
                        <option value="Libra">‚ôé Libra (Sep 23 - Oct 22)</option>
                        <option value="Scorpio">‚ôè Scorpio (Oct 23 - Nov 21)</option>
                        <option value="Sagittarius">‚ôê Sagittarius (Nov 22 - Dec 21)</option>
                        <option value="Capricorn">‚ôë Capricorn (Dec 22 - Jan 19)</option>
                        <option value="Aquarius">‚ôí Aquarius (Jan 20 - Feb 18)</option>
                        <option value="Pisces">‚ôì Pisces (Feb 19 - Mar 20)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-brain"></i> Personality Traits</label>
                    <textarea id="personality" placeholder="Describe your personality, strengths, and weaknesses..."></textarea>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-dream"></i> Life Goals</label>
                    <textarea id="lifeGoals" placeholder="What are your main goals in life?"></textarea>
                </div>
                <button class="btn-next" onclick="nextStep(3)">
                    <span>Next Step</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Step 4: Love Life -->
        <div class="step-card" id="step4">
            <div class="step-header" onclick="toggleStep(4)">
                <div class="step-number">4</div>
                <div class="step-title">
                    <h3>Love & Relationships</h3>
                    <p>Share your romantic journey</p>
                </div>
                <i class="fas fa-check-circle check-icon"></i>
            </div>
            <div class="step-content">
                <div class="form-group">
                    <label><i class="fas fa-heart"></i> Relationship Status *</label>
                    <select id="relationshipStatus" required>
                        <option value="">Select status</option>
                        <option value="Single">Single</option>
                        <option value="In a relationship">In a relationship</option>
                        <option value="Engaged">Engaged</option>
                        <option value="Married">Married</option>
                        <option value="Divorced">Divorced</option>
                        <option value="Widowed">Widowed</option>
                        <option value="It's complicated">It's complicated</option>
                    </select>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-clock"></i> Time in Current Relationship *</label>
                    <input type="text" id="relationshipDuration" placeholder="e.g., 2 years, 6 months, or 'Single'" required>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-users"></i> Number of Past Relationships *</label>
                    <input type="number" id="pastRelationships" placeholder="Number of past relationships" min="0" required>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-heartbeat"></i> What are you seeking in love?</label>
                    <textarea id="loveGoals" placeholder="Describe your ideal relationship or what you're looking for..."></textarea>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-heart-broken"></i> Biggest Relationship Challenge</label>
                    <textarea id="relationshipChallenge" placeholder="What challenges have you faced in relationships?"></textarea>
                </div>
                <button class="btn-next" onclick="nextStep(4)">
                    <span>Next Step</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Step 5: Spirit Guide -->
        <div class="step-card" id="step5">
            <div class="step-header" onclick="toggleStep(5)">
                <div class="step-number">5</div>
                <div class="step-title">
                    <h3>Spirit Guide</h3>
                    <p>Choose your cosmic companion</p>
                </div>
                <i class="fas fa-check-circle check-icon"></i>
            </div>
            <div class="step-content">
                <div class="form-group">
                    <label><i class="fas fa-paw"></i> Select Your Spirit Guide *</label>
                    <p style="opacity: 0.8; margin-bottom: 15px;">Your spirit animal will be matched with your zodiac sign</p>
                    <div class="spirit-guides">
                        <div class="guide-option" data-animal="Phoenix" data-emoji="üî•" onclick="selectGuide(this)">
                            <span class="guide-emoji">üî•</span>
                            <span class="guide-name">Phoenix</span>
                            <span class="guide-power">Rebirth</span>
                        </div>
                        <div class="guide-option" data-animal="Wolf" data-emoji="üê∫" onclick="selectGuide(this)">
                            <span class="guide-emoji">üê∫</span>
                            <span class="guide-name">Wolf</span>
                            <span class="guide-power">Loyalty</span>
                        </div>
                        <div class="guide-option" data-animal="Dragon" data-emoji="üêâ" onclick="selectGuide(this)">
                            <span class="guide-emoji">üêâ</span>
                            <span class="guide-name">Dragon</span>
                            <span class="guide-power">Wisdom</span>
                        </div>
                        <div class="guide-option" data-animal="Owl" data-emoji="ü¶â" onclick="selectGuide(this)">
                            <span class="guide-emoji">ü¶â</span>
                            <span class="guide-name">Owl</span>
                            <span class="guide-power">Intuition</span>
                        </div>
                        <div class="guide-option" data-animal="Lion" data-emoji="ü¶Å" onclick="selectGuide(this)">
                            <span class="guide-emoji">ü¶Å</span>
                            <span class="guide-name">Lion</span>
                            <span class="guide-power">Courage</span>
                        </div>
                        <div class="guide-option" data-animal="Unicorn" data-emoji="ü¶Ñ" onclick="selectGuide(this)">
                            <span class="guide-emoji">ü¶Ñ</span>
                            <span class="guide-name">Unicorn</span>
                            <span class="guide-power">Magic</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-comment-alt"></i> Special Message to the Universe</label>
                    <textarea id="universeMessage" placeholder="Write a message, wish, or question for the universe..."></textarea>
                </div>
                <button class="btn-next" onclick="generateFortune()">
                    <i class="fas fa-crystal-ball"></i>
                    <span>Generate My Fortune</span>
                </button>
            </div>
        </div>

        <!-- Fortune Display -->
        <div class="fortune-display" id="fortuneDisplay">
            <div class="zodiac-profile">
                <div class="profile-with-photo">
                    <img id="userPhotoDisplay" class="user-photo">
                    <div class="zodiac-icon-large" id="zodiacIcon">‚ú®</div>
                </div>
                <h2 id="fortuneName">Your Cosmic Reading</h2>
                <p class="subtitle" id="fortuneSubtitle">Your zodiac destiny revealed</p>
            </div>

            <div class="spirit-display">
                <span class="spirit-emoji-large" id="spiritEmoji">ü¶Å</span>
                <div>
                    <strong style="color: var(--accent);">Spirit Guide:</strong>
                    <span id="spiritName" style="color: var(--light); margin-left: 10px;">Lion</span>
                </div>
            </div>

            <div class="fortune-section">
                <h4><i class="fas fa-sun"></i> Today's Cosmic Forecast</h4>
                <p class="fortune-text" id="dailyReading">Your cosmic reading will appear here...</p>
            </div>

            <div class="fortune-section">
                <h4><i class="fas fa-heart"></i> Love & Relationships</h4>
                <p class="fortune-text" id="loveReading">Your love forecast will appear here...</p>
            </div>

            <div class="fortune-section">
                <h4><i class="fas fa-brain"></i> Personality Insights</h4>
                <p class="fortune-text" id="personalityReading">Your personality analysis will appear here...</p>
            </div>

            <div class="stats-grid">
                <div class="stat-box">
                    <span class="stat-label">Luck Score</span>
                    <span class="stat-value" id="luckScore">8.5/10</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Energy Level</span>
                    <span class="stat-value" id="energyLevel">High ‚ö°</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Lucky Day</span>
                    <span class="stat-value" id="luckyDay">Wednesday</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Power Color</span>
                    <span class="stat-value" id="powerColor">Yellow</span>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="btn-back" onclick="goBackToSteps()">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to Steps</span>
                </button>
                <button class="btn-next" onclick="showAllDetails()">
                    <i class="fas fa-eye"></i>
                    <span>View All Details</span>
                </button>
            </div>
        </div>

        <!-- All Details Display -->
        <div class="all-details-display" id="allDetailsDisplay">
            <h2><i class="fas fa-clipboard-list"></i> All Your Cosmic Details</h2>
            
            <div class="details-grid">
                <div class="details-section">
                    <h3><i class="fas fa-user"></i> Personal Information</h3>
                    <div class="detail-item">
                        <span class="detail-label">Full Name:</span>
                        <span class="detail-value" id="detailName"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Birth Date:</span>
                        <span class="detail-value" id="detailBirthDate"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Gender:</span>
                        <span class="detail-value" id="detailGender"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Email:</span>
                        <span class="detail-value" id="detailEmail"></span>
                    </div>
                </div>
                
                <div class="details-section">
                    <h3><i class="fas fa-camera"></i> Photo & Location</h3>
                    <div class="detail-item">
                        <span class="detail-label">Photo Status:</span>
                        <span class="detail-value" id="detailPhoto"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Location:</span>
                        <span class="detail-value" id="detailLocation"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Coordinates:</span>
                        <span class="detail-value" id="detailCoordinates"></span>
                    </div>
                </div>
                
                <div class="details-section">
                    <h3><i class="fas fa-sun"></i> Zodiac & Personality</h3>
                    <div class="detail-item">
                        <span class="detail-label">Zodiac Sign:</span>
                        <span class="detail-value" id="detailZodiac"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Personality Traits:</span>
                        <span class="detail-value" id="detailPersonality"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Life Goals:</span>
                        <span class="detail-value" id="detailLifeGoals"></span>
                    </div>
                </div>
                
                <div class="details-section">
                    <h3><i class="fas fa-heart"></i> Love & Relationships</h3>
                    <div class="detail-item">
                        <span class="detail-label">Relationship Status:</span>
                        <span class="detail-value" id="detailRelationshipStatus"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Relationship Duration:</span>
                        <span class="detail-value" id="detailRelationshipDuration"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Past Relationships:</span>
                        <span class="detail-value" id="detailPastRelationships"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Love Goals:</span>
                        <span class="detail-value" id="detailLoveGoals"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Relationship Challenge:</span>
                        <span class="detail-value" id="detailRelationshipChallenge"></span>
                    </div>
                </div>
                
                <div class="details-section">
                    <h3><i class="fas fa-paw"></i> Spirit Guide</h3>
                    <div class="detail-item">
                        <span class="detail-label">Spirit Guide:</span>
                        <span class="detail-value" id="detailSpiritGuide"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Spirit Guide Power:</span>
                        <span class="detail-value" id="detailSpiritPower"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Message to Universe:</span>
                        <span class="detail-value" id="detailUniverseMessage"></span>
                    </div>
                </div>
                
                <div class="details-section">
                    <h3><i class="fas fa-chart-line"></i> Fortune Stats</h3>
                    <div class="detail-item">
                        <span class="detail-label">Luck Score:</span>
                        <span class="detail-value" id="detailLuckScore"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Energy Level:</span>
                        <span class="detail-value" id="detailEnergyLevel"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Lucky Day:</span>
                        <span class="detail-value" id="detailLuckyDay"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Power Color:</span>
                        <span class="detail-value" id="detailPowerColor"></span>
                    </div>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="btn-back" onclick="goBackToFortune()">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to Fortune</span>
                </button>
                <button class="btn-next" onclick="showShareSection()">
                    <i class="fas fa-share-alt"></i>
                    <span>Share Your Fortune</span>
                </button>
            </div>
        </div>

        <!-- Share Your Fortune Section -->
        <div class="share-section" id="shareSection">
            <i class="fas fa-share-alt"></i>
            <h2>Share Your Cosmic Fortune</h2>
            <p>Spread your celestial wisdom with friends and family!</p>
            
            <div class="share-options">
                <div class="share-btn whatsapp" onclick="shareToWhatsApp()">
                    <i class="fab fa-whatsapp"></i>
                    <span class="share-label">WhatsApp</span>
                </div>
                <div class="share-btn instagram" onclick="shareToInstagram()">
                    <i class="fab fa-instagram"></i>
                    <span class="share-label">Instagram</span>
                </div>
                <div class="share-btn facebook" onclick="shareToFacebook()">
                    <i class="fab fa-facebook"></i>
                    <span class="share-label">Facebook</span>
                </div>
                <div class="share-btn twitter" onclick="shareToTwitter()">
                    <i class="fab fa-twitter"></i>
                    <span class="share-label">Twitter</span>
                </div>
                <div class="share-btn download" onclick="downloadFortuneImage()">
                    <i class="fas fa-download"></i>
                    <span class="share-label">Download</span>
                </div>
            </div>
            
            <div id="fortuneImageContainer" style="display: none;">
                <img id="fortuneImage" class="fortune-image" alt="Your Cosmic Fortune">
            </div>
            
            <div class="copy-link">
                <input type="text" id="shareableLink" readonly value="Your personal fortune link will appear here...">
                <button onclick="copyShareLink()">
                    <i class="fas fa-copy"></i> Copy Link
                </button>
            </div>
            
            <div class="qr-code" id="qrCodeContainer" style="display: none;">
                <p style="color: #000; margin-bottom: 10px;">Scan to view your fortune</p>
                <canvas id="qrCodeCanvas"></canvas>
            </div>
            
            <div class="nav-buttons">
                <button class="btn-back" onclick="goBackToDetails()">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to Details</span>
                </button>
                <button class="btn-next" onclick="showThankYouMessage()">
                    <i class="fas fa-check-circle"></i>
                    <span>Finish</span>
                </button>
            </div>
        </div>

        <!-- Thank You Message -->
        <div class="thank-you-message" id="thankYouMessage">
            <i class="fas fa-star"></i>
            <h2>Thank You!</h2>
            <p>Your cosmic journey has been recorded in the stars ‚ú®</p>
            <p style="opacity: 0.8; margin-top: 15px;">May the stars guide your path!</p>
            
            <div class="nav-buttons" style="margin-top: 30px;">
                <button class="btn-back" onclick="restartJourney()">
                    <i class="fas fa-redo"></i>
                    <span>Start New Journey</span>
                </button>
            </div>
        </div>
    </div>

    <script>
// ==========================================
// CONFIGURATION
// ==========================================
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyXZEO8fjy9QknunG5R9W28Nr5p0pmOPMBN6r55HSLRvb3p9KQlu6moAU99D2udhOydFA/exec';

const ZODIAC_DATA = {
    Aries: { emoji: '‚ôà', element: 'Fire', ruler: 'Mars', animal: 'Lion', traits: ['Courageous', 'Energetic', 'Impulsive'] },
    Taurus: { emoji: '‚ôâ', element: 'Earth', ruler: 'Venus', animal: 'Bull', traits: ['Reliable', 'Patient', 'Stubborn'] },
    Gemini: { emoji: '‚ôä', element: 'Air', ruler: 'Mercury', animal: 'Butterfly', traits: ['Adaptable', 'Curious', 'Indecisive'] },
    Cancer: { emoji: '‚ôã', element: 'Water', ruler: 'Moon', animal: 'Crab', traits: ['Emotional', 'Protective', 'Moody'] },
    Leo: { emoji: '‚ôå', element: 'Fire', ruler: 'Sun', animal: 'Lion', traits: ['Confident', 'Generous', 'Arrogant'] },
    Virgo: { emoji: '‚ôç', element: 'Earth', ruler: 'Mercury', animal: 'Owl', traits: ['Analytical', 'Practical', 'Critical'] },
    Libra: { emoji: '‚ôé', element: 'Air', ruler: 'Venus', animal: 'Swan', traits: ['Diplomatic', 'Social', 'Indecisive'] },
    Scorpio: { emoji: '‚ôè', element: 'Water', ruler: 'Pluto', animal: 'Phoenix', traits: ['Passionate', 'Determined', 'Secretive'] },
    Sagittarius: { emoji: '‚ôê', element: 'Fire', ruler: 'Jupiter', animal: 'Horse', traits: ['Optimistic', 'Adventurous', 'Tactless'] },
    Capricorn: { emoji: '‚ôë', element: 'Earth', ruler: 'Saturn', animal: 'Goat', traits: ['Ambitious', 'Disciplined', 'Pessimistic'] },
    Aquarius: { emoji: '‚ôí', element: 'Air', ruler: 'Uranus', animal: 'Dolphin', traits: ['Innovative', 'Humanitarian', 'Detached'] },
    Pisces: { emoji: '‚ôì', element: 'Water', ruler: 'Neptune', animal: 'Fish', traits: ['Compassionate', 'Artistic', 'Escapist'] }
};

// ==========================================
// GLOBAL VARIABLES
// ==========================================
let currentStep = 1;
let userData = {
    name: '',
    birthDate: '',
    gender: '',
    email: '',
    photo: '',
    location: '',
    zodiac: '',
    personality: '',
    lifeGoals: '',
    relationshipStatus: '',
    relationshipDuration: '',
    pastRelationships: 0,
    loveGoals: '',
    relationshipChallenge: '',
    spiritGuide: '',
    spiritEmoji: '',
    universeMessage: ''
};
let stream = null;
let locationData = {};
let currentView = 'steps'; // steps, fortune, details, share, thankyou

// ==========================================
// STEP NAVIGATION
// ==========================================
function toggleStep(stepNumber) {
    const stepCard = document.getElementById(`step${stepNumber}`);
    if (stepCard.classList.contains('completed')) return;
    
    document.querySelectorAll('.step-card').forEach(card => {
        card.classList.remove('active');
    });
    
    if (!stepCard.classList.contains('completed')) {
        stepCard.classList.add('active');
        currentStep = stepNumber;
    }
}

function nextStep(current) {
    // Validate current step
    if (!validateStep(current)) return;
    
    // Mark current as completed
    const currentCard = document.getElementById(`step${current}`);
    currentCard.classList.remove('active');
    currentCard.classList.add('completed');
    
    // Show next step
    const nextStep = current + 1;
    if (nextStep <= 5) {
        const nextCard = document.getElementById(`step${nextStep}`);
        nextCard.classList.add('active');
        currentStep = nextStep;
        
        // Scroll to next step
        nextCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}

function validateStep(step) {
    switch(step) {
        case 1:
            const name = document.getElementById('name').value.trim();
            const birthDate = document.getElementById('birthDate').value;
            const gender = document.getElementById('gender').value;
            const email = document.getElementById('email').value.trim();
            
            if (!name || !birthDate || !gender || !email) {
                alert('Please fill all required fields in Step 1');
                return false;
            }
            
            // Save data
            userData.name = name;
            userData.birthDate = birthDate;
            userData.gender = gender;
            userData.email = email;
            return true;
            
        case 2:
            if (!userData.photo) {
                alert('Please take a photo before proceeding');
                return false;
            }
            return true;
            
        case 3:
            const zodiac = document.getElementById('zodiacSign').value;
            if (!zodiac) {
                alert('Please select your zodiac sign');
                return false;
            }
            userData.zodiac = zodiac;
            userData.personality = document.getElementById('personality').value.trim();
            userData.lifeGoals = document.getElementById('lifeGoals').value.trim();
            return true;
            
        case 4:
            const relationshipStatus = document.getElementById('relationshipStatus').value;
            const relationshipDuration = document.getElementById('relationshipDuration').value.trim();
            const pastRelationships = document.getElementById('pastRelationships').value;
            
            if (!relationshipStatus || !relationshipDuration || pastRelationships === '') {
                alert('Please fill all required fields in Step 4');
                return false;
            }
            
            userData.relationshipStatus = relationshipStatus;
            userData.relationshipDuration = relationshipDuration;
            userData.pastRelationships = parseInt(pastRelationships) || 0;
            userData.loveGoals = document.getElementById('loveGoals').value.trim();
            userData.relationshipChallenge = document.getElementById('relationshipChallenge').value.trim();
            return true;
            
        case 5:
            if (!userData.spiritGuide) {
                alert('Please select a spirit guide');
                return false;
            }
            userData.universeMessage = document.getElementById('universeMessage').value.trim();
            return true;
    }
    return true;
}

// ==========================================
// CAMERA FUNCTIONALITY
// ==========================================
document.getElementById('startCamera').addEventListener('click', async () => {
    try {
        stream = await navigator.mediaDevices.getUserMedia({ 
            video: { 
                facingMode: 'user',
                width: { ideal: 1280 },
                height: { ideal: 720 }
            } 
        });
        
        const video = document.getElementById('video');
        video.srcObject = stream;
        video.style.display = 'block';
        
        document.getElementById('startCamera').style.display = 'none';
        document.getElementById('captureBtn').style.display = 'inline-flex';
        document.getElementById('disableCamera').style.display = 'inline-flex';
        
        // Get location
        getLocation();
        
    } catch (err) {
        alert('Camera access denied. Please allow camera access to continue.');
        console.error('Camera error:', err);
    }
});

document.getElementById('captureBtn').addEventListener('click', () => {
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const photoPreview = document.getElementById('photoPreview');
    
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    const context = canvas.getContext('2d');
    context.drawImage(video, 0, 0, canvas.width, canvas.height);
    
    const photoData = canvas.toDataURL('image/jpeg');
    photoPreview.src = photoData;
    photoPreview.style.display = 'block';
    video.style.display = 'none';
    
    userData.photo = photoData; // Save actual image data
    
    document.getElementById('captureBtn').style.display = 'none';
    document.getElementById('retakeBtn').style.display = 'inline-flex';
    document.getElementById('photoNextBtn').disabled = false;
});

document.getElementById('retakeBtn').addEventListener('click', () => {
    const video = document.getElementById('video');
    const photoPreview = document.getElementById('photoPreview');
    
    photoPreview.style.display = 'none';
    video.style.display = 'block';
    
    document.getElementById('captureBtn').style.display = 'inline-flex';
    document.getElementById('retakeBtn').style.display = 'none';
    document.getElementById('photoNextBtn').disabled = true;
});

document.getElementById('disableCamera').addEventListener('click', () => {
    if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
    }
    
    document.getElementById('video').style.display = 'none';
    document.getElementById('startCamera').style.display = 'inline-flex';
    document.getElementById('captureBtn').style.display = 'none';
    document.getElementById('disableCamera').style.display = 'none';
});

// ==========================================
// LOCATION FUNCTIONALITY
// ==========================================
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            (position) => {
                locationData = {
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    accuracy: position.coords.accuracy
                };
                
                // Get approximate address using reverse geocoding
                getAddressFromCoordinates(position.coords.latitude, position.coords.longitude);
                
                userData.location = `${position.coords.latitude}, ${position.coords.longitude}`;
            },
            (error) => {
                console.error('Geolocation error:', error);
                document.getElementById('locationText').textContent = 'Location access denied';
                document.getElementById('locationInfo').style.display = 'block';
                userData.location = 'Location not available';
            },
            { 
                enableHighAccuracy: true,
                timeout: 5000,
                maximumAge: 0
            }
        );
    } else {
        document.getElementById('locationText').textContent = 'Geolocation not supported';
        document.getElementById('locationInfo').style.display = 'block';
        userData.location = 'Not supported';
    }
}

async function getAddressFromCoordinates(lat, lng) {
    try {
        const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`);
        const data = await response.json();
        
        if (data.address) {
            const address = data.address;
            const locationString = `${address.road || ''} ${address.city || address.town || address.village || ''}, ${address.country || ''}`.trim();
            document.getElementById('locationText').textContent = locationString || 'Address not available';
        } else {
            document.getElementById('locationText').textContent = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
        }
    } catch (error) {
        document.getElementById('locationText').textContent = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
    }
    document.getElementById('locationInfo').style.display = 'block';
}

// ==========================================
// SPIRIT GUIDE SELECTION
// ==========================================
function selectGuide(element) {
    document.querySelectorAll('.guide-option').forEach(guide => {
        guide.classList.remove('selected');
    });
    
    element.classList.add('selected');
    userData.spiritGuide = element.dataset.animal;
    userData.spiritEmoji = element.dataset.emoji;
}

// ==========================================
// SAVE DATA TO GOOGLE SHEETS
// ==========================================
async function saveToGoogleSheets() {
    try {
        // Prepare data for Google Sheets using URLSearchParams
        const formData = new URLSearchParams();
        formData.append('timestamp', new Date().toISOString());
        formData.append('name', userData.name);
        formData.append('birthDate', userData.birthDate);
        formData.append('gender', userData.gender);
        formData.append('email', userData.email);
        formData.append('photo', userData.photo ? 'Photo captured' : 'No photo');
        formData.append('location', userData.location);
        formData.append('latitude', locationData.latitude || '');
        formData.append('longitude', locationData.longitude || '');
        formData.append('zodiac', userData.zodiac);
        formData.append('personality', userData.personality);
        formData.append('lifeGoals', userData.lifeGoals);
        formData.append('relationshipStatus', userData.relationshipStatus);
        formData.append('relationshipDuration', userData.relationshipDuration);
        formData.append('pastRelationships', userData.pastRelationships);
        formData.append('loveGoals', userData.loveGoals);
        formData.append('relationshipChallenge', userData.relationshipChallenge);
        formData.append('spiritGuide', userData.spiritGuide);
        formData.append('universeMessage', userData.universeMessage);
        
        console.log('Sending data to Google Sheets...');
        
        // Send to Google Sheets
        await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
            },
            body: formData.toString(),
            mode: 'no-cors'
        });
        
        console.log('Data saved successfully');
        
    } catch (error) {
        console.error('Error saving to Google Sheets:', error);
        throw error;
    }
}

// ==========================================
// VIEW NAVIGATION
// ==========================================
function showView(viewName) {
    // Hide all views
    document.querySelectorAll('.step-card').forEach(card => {
        card.style.display = 'none';
    });
    document.getElementById('fortuneDisplay').style.display = 'none';
    document.getElementById('allDetailsDisplay').style.display = 'none';
    document.getElementById('shareSection').style.display = 'none';
    document.getElementById('thankYouMessage').style.display = 'none';
    
    currentView = viewName;
    
    switch(viewName) {
        case 'steps':
            document.querySelectorAll('.step-card').forEach(card => {
                card.style.display = 'block';
            });
            document.getElementById('step5').scrollIntoView({ behavior: 'smooth' });
            break;
            
        case 'fortune':
            document.getElementById('fortuneDisplay').style.display = 'block';
            document.getElementById('fortuneDisplay').scrollIntoView({ behavior: 'smooth' });
            break;
            
        case 'details':
            populateAllDetails();
            document.getElementById('allDetailsDisplay').style.display = 'block';
            document.getElementById('allDetailsDisplay').scrollIntoView({ behavior: 'smooth' });
            break;
            
        case 'share':
            generateShareableContent();
            document.getElementById('shareSection').style.display = 'block';
            document.getElementById('shareSection').scrollIntoView({ behavior: 'smooth' });
            break;
            
        case 'thankyou':
            document.getElementById('thankYouMessage').style.display = 'block';
            document.getElementById('thankYouMessage').scrollIntoView({ behavior: 'smooth' });
            break;
    }
}

function goBackToSteps() {
    showView('steps');
}

function goBackToFortune() {
    showView('fortune');
}

function goBackToDetails() {
    showView('details');
}

function showAllDetails() {
    showView('details');
}

function showShareSection() {
    showView('share');
}

function showThankYouMessage() {
    showView('thankyou');
}

function restartJourney() {
    // Reset all form fields
    document.getElementById('name').value = '';
    document.getElementById('birthDate').value = '';
    document.getElementById('gender').value = '';
    document.getElementById('email').value = '';
    document.getElementById('personality').value = '';
    document.getElementById('lifeGoals').value = '';
    document.getElementById('relationshipStatus').value = '';
    document.getElementById('relationshipDuration').value = '';
    document.getElementById('pastRelationships').value = '0';
    document.getElementById('loveGoals').value = '';
    document.getElementById('relationshipChallenge').value = '';
    document.getElementById('zodiacSign').value = '';
    document.getElementById('universeMessage').value = '';
    
    // Reset user data
    userData = {
        name: '',
        birthDate: '',
        gender: '',
        email: '',
        photo: '',
        location: '',
        zodiac: '',
        personality: '',
        lifeGoals: '',
        relationshipStatus: '',
        relationshipDuration: '',
        pastRelationships: 0,
        loveGoals: '',
        relationshipChallenge: '',
        spiritGuide: '',
        spiritEmoji: '',
        universeMessage: ''
    };
    
    // Reset steps
    document.querySelectorAll('.step-card').forEach(card => {
        card.classList.remove('completed', 'active');
        card.style.display = 'block';
    });
    document.getElementById('step1').classList.add('active');
    currentStep = 1;
    
    // Reset photo
    document.getElementById('photoPreview').style.display = 'none';
    document.getElementById('photoNextBtn').disabled = true;
    document.getElementById('startCamera').style.display = 'inline-flex';
    document.getElementById('captureBtn').style.display = 'none';
    document.getElementById('retakeBtn').style.display = 'none';
    document.getElementById('disableCamera').style.display = 'none';
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ==========================================
// POPULATE ALL DETAILS
// ==========================================
function populateAllDetails() {
    const zodiac = ZODIAC_DATA[userData.zodiac];
    
    // Personal Information
    document.getElementById('detailName').textContent = userData.name || 'Not provided';
    document.getElementById('detailBirthDate').textContent = userData.birthDate || 'Not provided';
    document.getElementById('detailGender').textContent = userData.gender || 'Not provided';
    document.getElementById('detailEmail').textContent = userData.email || 'Not provided';
    
    // Photo & Location
    document.getElementById('detailPhoto').textContent = userData.photo ? 'Photo captured' : 'No photo';
    document.getElementById('detailLocation').textContent = document.getElementById('locationText').textContent || 'Not available';
    document.getElementById('detailCoordinates').textContent = locationData.latitude && locationData.longitude ? 
        `${locationData.latitude.toFixed(4)}, ${locationData.longitude.toFixed(4)}` : 'Not available';
    
    // Zodiac & Personality
    document.getElementById('detailZodiac').textContent = `${userData.zodiac || 'Not selected'} ${zodiac ? zodiac.emoji : ''}`;
    document.getElementById('detailPersonality').textContent = userData.personality || 'Not provided';
    document.getElementById('detailLifeGoals').textContent = userData.lifeGoals || 'Not provided';
    
    // Love & Relationships
    document.getElementById('detailRelationshipStatus').textContent = userData.relationshipStatus || 'Not provided';
    document.getElementById('detailRelationshipDuration').textContent = userData.relationshipDuration || 'Not provided';
    document.getElementById('detailPastRelationships').textContent = userData.pastRelationships || '0';
    document.getElementById('detailLoveGoals').textContent = userData.loveGoals || 'Not provided';
    document.getElementById('detailRelationshipChallenge').textContent = userData.relationshipChallenge || 'Not provided';
    
    // Spirit Guide
    document.getElementById('detailSpiritGuide').textContent = `${userData.spiritGuide || 'Not selected'} ${userData.spiritEmoji || ''}`;
    
    // Get spirit guide power
    const spiritPower = document.querySelector('.guide-option.selected') ? 
        document.querySelector('.guide-option.selected .guide-power').textContent : 'Not selected';
    document.getElementById('detailSpiritPower').textContent = spiritPower;
    
    document.getElementById('detailUniverseMessage').textContent = userData.universeMessage || 'Not provided';
    
    // Fortune Stats
    document.getElementById('detailLuckScore').textContent = document.getElementById('luckScore').textContent || '8.5/10';
    document.getElementById('detailEnergyLevel').textContent = document.getElementById('energyLevel').textContent || 'High ‚ö°';
    document.getElementById('detailLuckyDay').textContent = document.getElementById('luckyDay').textContent || 'Wednesday';
    document.getElementById('detailPowerColor').textContent = document.getElementById('powerColor').textContent || 'Yellow';
}

// ==========================================
// SHARING FUNCTIONALITY
// ==========================================
function generateShareableContent() {
    const zodiac = ZODIAC_DATA[userData.zodiac];
    const fortuneText = `üåü *My Cosmic Zodiac Fortune* üåü

*Name:* ${userData.name}
*Zodiac:* ${userData.zodiac} ${zodiac.emoji}
*Spirit Guide:* ${userData.spiritGuide} ${userData.spiritEmoji}
*Luck Score:* ${document.getElementById('luckScore').textContent}

*Today's Energy:*
${document.getElementById('dailyReading').textContent.substring(0, 150)}...

*Love Forecast:*
${document.getElementById('loveReading').textContent.substring(0, 150)}...

Discover your own cosmic fortune at: ${window.location.href}

#CosmicZodiac #Fortune #${userData.zodiac} #SpiritGuide`;
    
    // Set shareable link
    const shareLink = `${window.location.origin}${window.location.pathname}?name=${encodeURIComponent(userData.name)}&zodiac=${encodeURIComponent(userData.zodiac)}`;
    document.getElementById('shareableLink').value = shareLink;
    
    // Store for sharing
    window.shareableFortune = {
        text: fortuneText,
        link: shareLink,
        name: userData.name,
        zodiac: userData.zodiac,
        spiritGuide: userData.spiritGuide,
        emoji: userData.spiritEmoji
    };
    
    // Generate QR code
    generateQRCode(shareLink);
    
    // Generate fortune image
    generateFortuneImage();
}

function generateQRCode(text) {
    const canvas = document.getElementById('qrCodeCanvas');
    const container = document.getElementById('qrCodeContainer');
    
    try {
        const qrSize = 200;
        canvas.width = qrSize;
        canvas.height = qrSize;
        const ctx = canvas.getContext('2d');
        
        // Clear canvas
        ctx.fillStyle = '#FFFFFF';
        ctx.fillRect(0, 0, qrSize, qrSize);
        
        // Draw QR pattern
        ctx.fillStyle = '#000000';
        
        // Draw border
        ctx.fillRect(10, 10, qrSize - 20, 10);
        ctx.fillRect(10, 10, 10, qrSize - 20);
        ctx.fillRect(qrSize - 20, 10, 10, qrSize - 20);
        ctx.fillRect(10, qrSize - 20, qrSize - 20, 10);
        
        // Draw pattern squares
        const positions = [
            [30, 30], [30, 100], [30, 170],
            [100, 30], [100, 170],
            [170, 30], [170, 100], [170, 170]
        ];
        
        positions.forEach(([x, y]) => {
            ctx.fillRect(x, y, 40, 40);
        });
        
        container.style.display = 'block';
    } catch (error) {
        console.error('QR generation error:', error);
        container.style.display = 'none';
    }
}

function generateFortuneImage() {
    const zodiac = ZODIAC_DATA[userData.zodiac];
    const container = document.getElementById('fortuneImageContainer');
    const imageElement = document.getElementById('fortuneImage');
    
    // Create a canvas for the fortune image
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = 800;
    canvas.height = 1200;
    
    // Draw background
    ctx.fillStyle = '#0a0a1a';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Draw stars
    ctx.fillStyle = '#FFFFFF';
    for (let i = 0; i < 100; i++) {
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height;
        const size = Math.random() * 2;
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();
    }
    
    // Draw title
    ctx.fillStyle = '#00d4ff';
    ctx.font = 'bold 40px Cinzel, serif';
    ctx.textAlign = 'center';
    ctx.fillText('‚ú® Cosmic Zodiac Fortune ‚ú®', canvas.width / 2, 80);
    
    // Draw user info
    ctx.fillStyle = '#e6e6ff';
    ctx.font = '30px Space Grotesk, sans-serif';
    ctx.fillText(`${userData.name}'s Reading`, canvas.width / 2, 150);
    
    ctx.font = '25px Space Grotesk, sans-serif';
    ctx.fillText(`${userData.zodiac} ${zodiac.emoji} ‚Ä¢ ${zodiac.element} Sign`, canvas.width / 2, 200);
    ctx.fillText(`Spirit Guide: ${userData.spiritGuide} ${userData.spiritEmoji}`, canvas.width / 2, 250);
    
    // Draw readings
    ctx.font = '20px Space Grotesk, sans-serif';
    ctx.textAlign = 'left';
    const dailyReading = document.getElementById('dailyReading').textContent;
    wrapText(ctx, dailyReading, 50, 350, canvas.width - 100, 30);
    
    // Convert to image
    imageElement.src = canvas.toDataURL('image/png');
    container.style.display = 'block';
}

function wrapText(context, text, x, y, maxWidth, lineHeight) {
    const words = text.split(' ');
    let line = '';
    let lines = [];
    
    for(let n = 0; n < words.length; n++) {
        const testLine = line + words[n] + ' ';
        const metrics = context.measureText(testLine);
        const testWidth = metrics.width;
        if (testWidth > maxWidth && n > 0) {
            lines.push(line);
            line = words[n] + ' ';
        } else {
            line = testLine;
        }
    }
    lines.push(line);
    
    for(let i = 0; i < lines.length; i++) {
        context.fillText(lines[i], x, y + (i * lineHeight));
    }
    return lines.length;
}

// ==========================================
// SHARE BUTTON FUNCTIONS
// ==========================================
function shareToWhatsApp() {
    const text = window.shareableFortune.text;
    const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
    window.open(url, '_blank');
}

function shareToInstagram() {
    alert('To share on Instagram:\n1. Take a screenshot of your fortune\n2. Post it to your Instagram story\n3. Tag #CosmicZodiacOracle\n\nYour fortune image has been generated below!');
    document.getElementById('fortuneImageContainer').style.display = 'block';
    document.getElementById('fortuneImageContainer').scrollIntoView({ behavior: 'smooth' });
}

function shareToFacebook() {
    const url = encodeURIComponent(window.shareableFortune.link);
    const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
    window.open(facebookUrl, '_blank', 'width=600,height=400');
}

function shareToTwitter() {
    const text = `üåü Just discovered my cosmic zodiac fortune! I'm a ${userData.zodiac} with ${userData.spiritGuide} as my spirit guide! Check yours at:`;
    const url = window.shareableFortune.link;
    const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}&hashtags=CosmicZodiac,Fortune,${userData.zodiac}`;
    window.open(twitterUrl, '_blank', 'width=600,height=400');
}

function downloadFortuneImage() {
    const imageElement = document.getElementById('fortuneImage');
    const link = document.createElement('a');
    link.download = `cosmic-fortune-${userData.name.toLowerCase().replace(/\s+/g, '-')}.png`;
    link.href = imageElement.src;
    link.click();
}

function copyShareLink() {
    const input = document.getElementById('shareableLink');
    input.select();
    input.setSelectionRange(0, 99999);
    
    try {
        navigator.clipboard.writeText(input.value).then(() => {
            const originalText = input.value;
            input.value = 'Link copied to clipboard! ‚úì';
            input.style.color = 'var(--success)';
            
            setTimeout(() => {
                input.value = originalText;
                input.style.color = 'var(--light)';
            }, 2000);
        });
    } catch (err) {
        document.execCommand('copy');
        const originalText = input.value;
        input.value = 'Link copied to clipboard! ‚úì';
        input.style.color = 'var(--success)';
        
        setTimeout(() => {
            input.value = originalText;
            input.style.color = 'var(--light)';
        }, 2000);
    }
}

// ==========================================
// GENERATE FORTUNE
// ==========================================
async function generateFortune() {
    if (!validateStep(5)) return;
    
    // Show loading overlay
    const loadingOverlay = document.getElementById('loadingOverlay');
    loadingOverlay.style.display = 'flex';
    
    try {
        // Save all data to Google Sheets
        await saveToGoogleSheets();
        
        // Hide loading
        loadingOverlay.style.display = 'none';
        
        // Generate and show fortune readings
        generateFortuneContent();
        
        // Show fortune display
        showView('fortune');
        
    } catch (error) {
        console.error('Error generating fortune:', error);
        loadingOverlay.style.display = 'none';
        alert('Error generating fortune. Please try again.');
    }
}

function generateFortuneContent() {
    const zodiac = ZODIAC_DATA[userData.zodiac];
    
    // Display user photo if available
    if (userData.photo && userData.photo.startsWith('data:image')) {
        const userPhotoDisplay = document.getElementById('userPhotoDisplay');
        userPhotoDisplay.src = userData.photo;
        userPhotoDisplay.style.display = 'block';
    }
    
    // Set zodiac icon and info
    document.getElementById('zodiacIcon').textContent = zodiac.emoji;
    document.getElementById('fortuneName').textContent = `${userData.name}'s Cosmic Reading`;
    document.getElementById('fortuneSubtitle').textContent = `${userData.zodiac} ‚Ä¢ ${zodiac.element} Sign ‚Ä¢ Ruled by ${zodiac.ruler}`;
    
    // Spirit guide
    document.getElementById('spiritEmoji').textContent = userData.spiritEmoji;
    document.getElementById('spiritName').textContent = userData.spiritGuide;
    
    // Generate detailed readings
    const dailyReading = generateDetailedDailyReading(zodiac, userData);
    const loveReading = generateDetailedLoveReading(userData);
    const personalityReading = generateDetailedPersonalityReading(zodiac, userData);
    
    document.getElementById('dailyReading').innerHTML = dailyReading;
    document.getElementById('loveReading').innerHTML = loveReading;
    document.getElementById('personalityReading').innerHTML = personalityReading;
    
    // Generate stats
    document.getElementById('luckScore').textContent = generateLuckScore();
    document.getElementById('energyLevel').textContent = generateEnergyLevel(zodiac);
    document.getElementById('luckyDay').textContent = generateLuckyDay(zodiac);
    document.getElementById('powerColor').textContent = generatePowerColor(zodiac);
}

// More detailed reading functions
function generateDetailedDailyReading(zodiac, userData) {
    const today = new Date();
    const dayOfMonth = today.getDate();
    const month = today.getMonth() + 1;
    const hour = today.getHours();
    
    const readings = [
        `üåü <strong>Cosmic Forecast for Today:</strong> The ${zodiac.element.toLowerCase()} element of your ${userData.zodiac} sign brings powerful ${hour < 12 ? 'morning' : 'evening'} energy. ${dayOfMonth % 7 === 0 ? 'Today is exceptionally lucky!' : 'Expect positive developments.'}`,
        
        `‚ú® <strong>${userData.spiritGuide}'s Guidance:</strong> Your spirit animal ${userData.spiritEmoji} guides you toward ${['creativity', 'intuition', 'communication', 'strength'][dayOfMonth % 4]}. Trust its wisdom in decisions today.`,
        
        `üåô <strong>Lunar Influence:</strong> With the moon in ${['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces'][month - 1]}, your ${zodiac.traits[1].toLowerCase()} traits are amplified.`,
        
        `üí´ <strong>Planetary Alignment:</strong> ${zodiac.ruler}'s current position favors ${['career moves', 'relationships', 'personal growth', 'financial decisions'][dayOfMonth % 4]}. Seize opportunities before ${hour < 18 ? 'sunset' : 'midnight'}.`,
        
        `üîÆ <strong>Your Cosmic Message:</strong> ${userData.universeMessage ? `"${userData.universeMessage}" - The universe acknowledges your wish.` : 'The stars whisper: "Trust your journey, for destiny unfolds in mysterious ways."'}`
    ];
    
    return readings[dayOfMonth % readings.length];
}

function generateDetailedLoveReading(userData) {
    const relationshipKeywords = {
        'Single': ['new beginnings', 'self-discovery', 'preparation'],
        'In a relationship': ['growth', 'deepening bonds', 'understanding'],
        'Engaged': ['commitment', 'future planning', 'celebration'],
        'Married': ['stability', 'partnership', 'enduring love'],
        'Divorced': ['healing', 'new perspectives', 'rebuilding'],
        'Widowed': ['remembrance', 'strength', 'continuation'],
        'It\'s complicated': ['clarity-seeking', 'patience', 'understanding']
    };
    
    const keywords = relationshipKeywords[userData.relationshipStatus] || ['growth', 'understanding', 'love'];
    
    let reading = `<strong>${userData.relationshipStatus} Journey:</strong> `;
    
    if (userData.relationshipStatus === 'Single') {
        reading += `The cosmos indicates ${userData.pastRelationships > 0 ? 'a more mature connection' : 'a significant encounter'} within ${Math.max(1, 12 - userData.pastRelationships)} months. `;
        reading += `Your ${userData.spiritGuide} energy attracts partners who value ${userData.pastRelationships > 2 ? 'depth and commitment' : 'adventure and spontaneity'}.`;
    } else if (userData.relationshipStatus.includes('relationship') || userData.relationshipStatus === 'Married' || userData.relationshipStatus === 'Engaged') {
        reading += `Celebrating ${userData.relationshipDuration} together aligns with Venus's cycle. `;
        reading += `${userData.pastRelationships > 0 ? 'Lessons from past relationships strengthen your current bond.' : 'This connection carries karmic significance.'} `;
        reading += `${userData.loveGoals ? `Your desire for ${userData.loveGoals.toLowerCase()} finds cosmic support this season.` : ''}`;
    } else {
        reading += `This phase emphasizes ${keywords.join(' and ')}. `;
        reading += `Your ${userData.spiritGuide} guide provides strength. `;
        reading += `${userData.relationshipChallenge ? `The challenge of ${userData.relationshipChallenge.toLowerCase()} transforms into profound wisdom.` : 'New chapters await with renewed perspective.'}`;
    }
    
    reading += `<br><br><em>Venus advises: ${['Communicate openly', 'Practice patience', 'Express gratitude', 'Listen deeply', 'Share vulnerabilities', 'Celebrate small moments'][new Date().getDay()]} in matters of the heart.</em>`;
    
    return reading;
}

function generateDetailedPersonalityReading(zodiac, userData) {
    let reading = `<strong>${userData.zodiac} Archetype Analysis:</strong> `;
    reading += `As a ${zodiac.element.toLowerCase()} sign ruled by ${zodiac.ruler}, you embody ${zodiac.traits.join(', ').toLowerCase()}. `;
    
    if (userData.personality) {
        reading += `Your self-description "${userData.personality.substring(0, 80)}${userData.personality.length > 80 ? '...' : ''}" reveals ${userData.personality.includes('creative') ? 'artistic' : userData.personality.includes('logical') ? 'analytical' : 'dynamic'} dimensions. `;
    }
    
    if (userData.lifeGoals) {
        reading += `Your aspiration for ${userData.lifeGoals.toLowerCase()} aligns with ${zodiac.ruler}'s influence, suggesting ${['steady progress', 'sudden breakthroughs', 'gradual mastery', 'inspired action'][zodiac.element === 'Fire' ? 1 : zodiac.element === 'Air' ? 3 : zodiac.element === 'Water' ? 0 : 2]}. `;
    }
    
    reading += `<br><br><strong>Elemental Advantage:</strong> Your ${zodiac.element.toLowerCase()} nature excels in ${zodiac.element === 'Fire' ? 'leadership and initiative' : zodiac.element === 'Earth' ? 'practicality and stability' : zodiac.element === 'Air' ? 'communication and innovation' : 'intuition and empathy'}.`;
    
    reading += `<br><br><strong>Spirit Guide Synergy:</strong> The ${userData.spiritGuide} (${userData.spiritEmoji}) enhances your natural ${zodiac.traits[0].toLowerCase()}, offering protection in ${['career challenges', 'emotional matters', 'social situations', 'personal growth'][new Date().getHours() % 4]}.`;
    
    return reading;
}

function generateLuckScore() {
    const baseScore = 5 + Math.floor(Math.random() * 4);
    const decimal = Math.random();
    const total = baseScore + decimal;
    return `${total.toFixed(1)}/10`;
}

function generateEnergyLevel(zodiac) {
    const levels = ['Low ‚ö°', 'Medium ‚ö°', 'High ‚ö°', 'Very High ‚ö°‚ö°'];
    const index = zodiac.element === 'Fire' ? 3 : zodiac.element === 'Air' ? 2 : zodiac.element === 'Water' ? 1 : 0;
    return levels[index];
}

function generateLuckyDay(zodiac) {
    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    const index = zodiac.ruler === 'Mars' ? 1 : 
                  zodiac.ruler === 'Mercury' ? 2 : 
                  zodiac.ruler === 'Jupiter' ? 3 : 
                  zodiac.ruler === 'Venus' ? 4 : 
                  zodiac.ruler === 'Saturn' ? 5 : 
                  zodiac.ruler === 'Sun' ? 6 : 0;
    return days[index];
}

function generatePowerColor(zodiac) {
    const colors = {
        'Fire': ['Red', 'Orange', 'Gold'],
        'Earth': ['Green', 'Brown', 'Black'],
        'Air': ['Blue', 'Yellow', 'White'],
        'Water': ['Purple', 'Silver', 'Teal']
    };
    const zodiacColors = colors[zodiac.element];
    return zodiacColors[Math.floor(Math.random() * zodiacColors.length)];
}

// ==========================================
// INITIALIZE
// ==========================================
document.addEventListener('DOMContentLoaded', () => {
    // Set today's date as max for birth date
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('birthDate').max = today;
    
    // Set default value for past relationships
    document.getElementById('pastRelationships').value = '0';
});
    </script>
</body>
</html>
